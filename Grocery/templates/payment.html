{% extends 'index.html' %}
{% load static %}
{% block front %}
{% endblock %}
{% block category %}
{% endblock %}
{% block product %}
{% endblock %}
{% block featured %}
{% endblock %}
{% block popular %}
{% endblock %}
{% block blog %}
{% endblock %}
{% block login %}
{% load cart %}
<html>
    <head>
        <title>
            Organic - Grocery Store Website Login
        </title>
    </head>
    <body >
<div class="container my-4">
    <div class="row">
        <!-- Address Section -->
        <div class="col-md-7">
            <h5 class="mb-3">Choose your address</h5>
{% for x in save %}
<div class="border rounded p-3 mb-3">
    <div class="form-check">
    <a href="/Delete_Product/?id={{ x.id }}"><span class="fw-semibold btn text-danger" style="padding-left:600px;">Remove</a></span><br>
        <input class="form-check-input" style="margin-top:-25px" type="radio"
               name="address">        
        <label class="form-check-label" style="margin-top:-30px" for="address{{ forloop.counter }}">
            <strong>{{ x.address }}</strong><br>
            {{ x.phone }} <br>
            {{ x.city }} <br>
            {{ x.pincode }} <br>
            {{ x.date }}
        </label>
    </div>
</div>
{% endfor %}
            <div class="border rounded text-center p-3" data-bs-toggle="offcanvas" data-bs-target="#offcanvascart"style="background:#f7fbff;">
             <a href="#"><div class="text-success fw-semibold">Add Address</div></a>
            </div>
        </div>
        <!-- Summary Section -->
        <div class="col-md-5">
            <div class="border rounded p-3 bg-white">
                <h5 class="mb-3">Summary</h5>
<hr>
                <p class="mb-2"><strong>Bill details</strong></p>

                <div class="d-flex justify-content-between">
                    <span>Items total</span>
                    <span>
                        <del class="text-muted">{{ product|total_del_price:request.session.cart|currency }}</del>
                        <strong>{{ product|total_cart_price:request.session.cart|currency }}</strong>
                    </span>
                </div>

                <div class="d-flex justify-content-between mt-2">
                    <span>Quantity total</span>
                    <span>{{request.session.cart.keys|length}} Items</span>
                </div>

                <div class="d-flex justify-content-between mt-2">
                    <span>Delivery Charge</span>
                    <span class="text-success">Free</span>
                </div>

                <hr>

                <div class="d-flex justify-content-between mb-3">
                    <strong>Grand total</strong>
                    <strong>{{ product|total_cart_price:request.session.cart|currency }}</strong>
                   
                </div>

                <button id="rzp-button1" class="btn btn-success w-100 mb-2">Online Payment</button>
                <button id="rzp-button1" class="btn btn-outline-success w-100">Cash on Delivery</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="offcanvas offcanvas-end" data-bs-scroll="true" tabindex="-1" id="offcanvascart">
      <div class="offcanvas-header justify-content-center">
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body">
        <div class="order-md-last">
          <h4 class="d-flex justify-content-between align-items-center mb-3">
            <span class="text-sbtn-success">Check Out Form </span>
            <span class="badge bg-sbtn-success rounded-pill">3</span>
          </h4>
          <hr>
          <div class="m-3 p-1"></div>
          <form method="post">
            {% csrf_token %}
            <div class="form-group">
                <label for="" class="fw-semibold" style="font-size: 20px;">Address</label>
                <input type="text" name="address" id=""
                class="form-control" style="font-size: 18px;" placeholder="Enter Your Address:" required>
            </div>
            <div class="form-group">
                <label for="" class="fw-semibold" style="font-size: 20px;">Phone</label>
                <input type="text" name="phone" id=""
                class="form-control" style="font-size: 18px;" placeholder="Enter Your Phone Number:" required>
            </div>
            <div class="form-group">
                <label for="" class="fw-semibold" style="font-size: 20px;">City</label>
                <input type="text" name="city" id=""
                class="form-control" style="font-size: 18px;" placeholder="Enter Your City:" required>
            </div>
            <div class="form-group">
                <label for="" class="fw-semibold" style="font-size: 20px;">Pincode</label>
                <input type="text" name="pincode" id=""
                class="form-control mb-3" style="font-size: 18px;" placeholder="Enter Your PinCode:" required>
            </div>            
            </div>
       <a href="#"><button class="w-100 btn btn-success btn-lg" type="submit">Add New Address</button></a>
          </form>
        </div>
      </div>
    </div>

    
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
var options = {
    "key":"rzp_test_RjujhFUrLtML2M", // Enter the Key ID generated from the Dashboard
    "amount": "{{payment.amount}}", // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
    "currency": "INR",
    "name": "Organic - Grocery Store Website",
    "description": "Test Transaction",
    "buttontext": "Online Payment",
    "order_id": "{{ payment.id }}", //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
    "handele": function(response){
        alert(response.Razorpay_payment_id);
        alert(response.Razorpay_order_id);
        alert(response.Razorpay_signature); 
    },
    "theme": {"color": "#33cc33ff"}
    };
var rzp1 = new Razorpay(options);
rzp1.on('payment.failed', function (response){
        alert(response.error.code);
        alert(response.error.description);
        alert(response.error.source);
        alert(response.error.step);
        alert(response.error.reason);
        alert(response.error.metadata.order_id);
        alert(response.error.metadata.payment_id);
});
document.getElementById('rzp-button1').onclick = function(e){
    rzp1.open();
    e.preventDefault();
}
</script>
</body>
</html>
{% endblock %}

